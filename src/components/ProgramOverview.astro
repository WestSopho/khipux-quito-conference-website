---
import bulletpoint1 from "../assets/desc-bulletpoint-1.svg";
import bulletpoint2 from "../assets/desc-bulletpoint-2.svg";
import bulletpoint3 from "../assets/desc-bulletpoint-3.svg";
import khipuSquare from "../assets/khipu-square.svg";

const days = [
  {
    name: "Day 1",
    theme: "Foundations and Regional Landscape",
    bulletpoint: bulletpoint1,
    items: [
      { title: "Welcome session and opening remarks" },
      {
        title:
          'Keynote Lecture (TBD) – "The future of AI in biomedical research in Latin America"',
        note: "invited speaker",
      },
      {
        title:
          'Panel Discussion – "Building regional capacity in AI for bio and medical imaging"',
        panellists: [
          "Andrea Lara (Guatemala, Universidad Galileo)",
          "Agustín Corbat (Universidad de Buenos Aires)",
          "Hernán Morales-Navarrete (Ecuador, UDLA)",
          "David Brito (Solca)",
        ],
      },
      {
        title: "Poster session",
        note: "Presentations from selected student and early-career participants",
      },
      {
        title: "Networking Mixer",
        note: "Facilitated community-building space with interdisciplinary round tables",
      },
    ],
  },
  {
    name: "Day 2",
    theme: "Technical Training and Scientific Exchange",
    bulletpoint: bulletpoint2,
    items: [
      {
        title: "Expert Lectures and Workshops",
        workshops: [
          {
            topic: "Artificial intelligence for medical image analysis",
            speaker: "Andrea Lara",
          },
          {
            topic: "Introduction to bioimage analysis",
            speaker: "Agustín Corbat",
          },
          {
            topic: "AI models for bioimage analysis",
            speaker: "Hernán Morales-Navarrete",
          },
        ],
      },
      {
        title: "Poster session",
        note: "Presentations from selected student and early-career participants",
      },
      {
        title: "Mentorship circles",
        note: "Topic-based small group mentoring with guest speakers",
      },
      {
        title: "Community dinner",
        note: "Informal gathering to foster networking and trust",
      },
    ],
  },
  {
    name: "Day 3",
    theme: "Ethical AI and Hackathon",
    bulletpoint: bulletpoint3,
    items: [
      {
        title:
          'Roundtable – "Ethical AI, equity, and data sovereignty in Latin America"',
        note: "Moderated by Diana Mosquera (Diversa) (TBC), with invited representatives from multiple disciplines",
      },
      {
        title: "Hackathon launch",
        note: "Teams develop AI-based tools for regionally relevant bioimage or medical imaging problems (data provided)",
      },
      { title: "Hackathon showcase & jury evaluation" },
      { title: "Award ceremony and closing" },
    ],
  },
];
---

<section id="schedule" class="bg-khipu-gray text-khipu-white py-12">
  <div class="content-container">
    <h2 class="mb-10 text-center text-4xl font-bold md:text-6xl">
      Program <span class="text-khipu-orange">Overview</span>
    </h2>

    <!-- Day Tabs -->
    <div class="mb-8 flex gap-6">
      {
        days.map((day, index) => (
          <button
            class:list={[
              "day-tab relative pb-2 text-2xl font-bold transition-colors md:text-3xl",
              index === 0
                ? "text-khipu-orange active"
                : "text-khipu-white hover:text-khipu-orange",
            ]}
            data-day={index}
          >
            {day.name}
          </button>
        ))
      }
    </div>

    <!-- Day Content Panels Container -->
    <div class="min-h-[28rem] md:min-h-[32rem]">
      {
        days.map((day, index) => (
          <div
            class:list={[
              "day-panel transition-opacity duration-300 ease-out",
              index === 0 ? "opacity-100" : "hidden opacity-0",
            ]}
            data-day-panel={index}
          >
            {/* Day Theme with Bulletpoint */}
            <div class="mb-8 flex items-center justify-center gap-4">
              <img
                src={day.bulletpoint.src}
                alt=""
                width="64"
                height="48"
                loading="lazy"
                decoding="async"
                class="h-12 w-auto opacity-80 md:h-16"
              />
              <h3 class="text-center text-xl font-bold md:text-2xl">
                {day.theme}
              </h3>
              <img
                src={day.bulletpoint.src}
                alt=""
                width="64"
                height="48"
                loading="lazy"
                decoding="async"
                class="h-12 w-auto opacity-80 md:h-16"
                style="transform: scaleX(-1)"
              />
            </div>

            {/* Items - Timeline */}
            <ul class="timeline relative ml-4 space-y-1 md:ml-6">
              {day.items.map((item) => (
                <li class="timeline-item group relative pl-10 md:pl-12">
                  {/* Timeline dot */}
                  <div class="timeline-dot bg-khipu-orange group-hover:bg-khipu-white absolute top-4 left-0 h-3 w-3 rounded-full transition-all duration-300 group-hover:scale-150 md:h-4 md:w-4" />

                  {/* Content card with hover glow */}
                  <div class="relative rounded-lg px-4 py-3 transition-all duration-300 group-hover:bg-white/5">
                    {/* Glow effect */}
                    <div class="bg-khipu-orange/0 group-hover:bg-khipu-orange/10 pointer-events-none absolute -inset-1 rounded-lg blur-xl transition-all duration-500" />

                    <div class="relative">
                      <span class="text-lg font-semibold md:text-xl">
                        {item.title}
                      </span>
                      {item.note && (
                        <span class="ml-2 text-base text-white/70 md:text-lg">
                          — {item.note}
                        </span>
                      )}

                      {/* Panellists */}
                      {item.panellists && (
                        <div class="mt-3 ml-2">
                          <span class="text-khipu-orange text-sm font-semibold tracking-wide uppercase">
                            Panellists:
                          </span>
                          <ul class="mt-2 space-y-2">
                            {item.panellists.map((panellist) => (
                              <li class="flex items-center gap-3 text-base text-white/80">
                                <img
                                  src={khipuSquare.src}
                                  alt=""
                                  width="16"
                                  height="16"
                                  loading="lazy"
                                  decoding="async"
                                  class="bullet-orange h-4 w-4 shrink-0 rotate-45"
                                />
                                {panellist}
                              </li>
                            ))}
                          </ul>
                        </div>
                      )}

                      {/* Workshops */}
                      {item.workshops && (
                        <ul class="mt-3 ml-2 space-y-2">
                          {item.workshops.map((workshop) => (
                            <li class="flex items-start gap-3">
                              <img
                                src={khipuSquare.src}
                                alt=""
                                width="16"
                                height="16"
                                loading="lazy"
                                decoding="async"
                                class="bullet-orange mt-1 h-4 w-4 shrink-0 rotate-45"
                              />
                              <div>
                                <span class="text-base text-white/90 md:text-lg">
                                  {workshop.topic}
                                </span>
                                <span class="text-khipu-orange ml-2 text-base font-semibold">
                                  — {workshop.speaker}
                                </span>
                              </div>
                            </li>
                          ))}
                        </ul>
                      )}
                    </div>
                  </div>
                </li>
              ))}
            </ul>
          </div>
        ))
      }
    </div>
  </div>
</section>

<script>
  const tabs = document.querySelectorAll(".day-tab");
  const panels = document.querySelectorAll(".day-panel");

  tabs.forEach((tab) => {
    tab.addEventListener("click", () => {
      const dayIndex = tab.getAttribute("data-day");
      const targetPanel = document.querySelector(
        `[data-day-panel="${dayIndex}"]`,
      );

      // Update tabs
      tabs.forEach((t) => {
        t.classList.remove("text-khipu-orange", "active");
        t.classList.add("text-khipu-white");
      });
      tab.classList.add("text-khipu-orange", "active");
      tab.classList.remove("text-khipu-white");

      // Fade out all panels
      panels.forEach((p) => {
        p.classList.add("opacity-0");
        p.classList.remove("opacity-100");
      });

      // After fade out, hide all and show target with fade in
      setTimeout(() => {
        panels.forEach((p) => p.classList.add("hidden"));
        targetPanel?.classList.remove("hidden");

        // Trigger reflow for animation
        requestAnimationFrame(() => {
          targetPanel?.classList.remove("opacity-0");
          targetPanel?.classList.add("opacity-100");
        });
      }, 150);
    });
  });
</script>

<style>
  .bullet-orange {
    filter: brightness(0) saturate(100%) invert(47%) sepia(78%) saturate(1057%)
      hue-rotate(339deg) brightness(94%) contrast(92%);
  }

  .day-tab::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: var(--color-khipu-orange);
    transform: scaleX(0);
    transition: transform 0.3s ease;
  }

  .day-tab.active::after {
    transform: scaleX(1);
  }

  .day-tab:hover::after {
    transform: scaleX(0.5);
  }

  .day-tab.active:hover::after {
    transform: scaleX(1);
  }

  /* Timeline vertical line */
  .timeline::before {
    content: "";
    position: absolute;
    left: 5px;
    top: 1.5rem;
    bottom: 1.5rem;
    width: 2px;
    background: linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.3),
      rgba(255, 255, 255, 0.1)
    );
  }

  @media (min-width: 768px) {
    .timeline::before {
      left: 7px;
    }
  }
</style>
